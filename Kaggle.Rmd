# Kaggle Project

M'barek Aissam - Maurel Thibaut - EL Schneider  Lillian - Lucaroni tino MAM4
Base de donnée choisie : Student Grade Prediction 

1-  Installation des package et importation:

```{r}
student<- read.csv('student-mat.csv')

#install.packages("ggplot2")
#install.packages("party")
#install.packages("rsample")

#library(rsample)

library(ggplot2)
library(dplyr)
library(party)
library(rsample)
```

```{r}
install.packages("pheatmap", dep=T) 
numeric_features <- Filter(is.numeric, student)

library(pheatmap)
pheatmap(cor(numeric_features))
```

2-   Description de la base de données :

Nous avons accès aux informations suivantes :

• Le nom de l'école que fréquente l'étudiant                    (Binaire: 'GP' - Gabriel Pereira ou 'MS' - Mousinho da 
                                                                Silveira)
• Le sexe de l'étudiant                                         (Binaire: 'F' - female ou 'M' - male)
• L'age de l'étudiant                                           (Numérique: de 15 à 22)
• L'adresse de l'étudiant                                       (Binaire: 'U' - urbain ou 'R' - rural)
• La taille de la famille  de l'étudiant                        (Binaire:'LE3'-less or equal a  3 ou GT3-greater than 3)
• Le statut des parents   de l'étudiant                         (Binaire: 'T' - living together or 'A' - apart)
• La formation du pere   de l'étudiant                          (Numérique: 0 - aucune , 1 - Ecole  ,2 - College , 
                                                                3 - Lycee , 4 - Supérieur )
• La formation de la mere  de l'étudiant                         (Numérique: 0 - aucune , 1 - Ecole  ,2 - College , 
                                                                3 - Lycee , 4 - Supérieur )                              
• Le metier du pere  de l'étudiant                              (Nominal: 'teacher', 'health' care related, civil                                                                        'services' , 'at_home' or 'other')
• Le metier  de la mere  de l'étudiant                          (Nominal: 'teacher', 'health' care related, civil                                                                        'services' , 'at_home' or 'other')
• Les raison du choix de cette ecole                            (Nominal: close to 'home', school 'reputation', '                                                                        course' preference or'other')
• Le tuteur de l'étudiant                                       (Nominal: 'mother', 'father' ou 'other')
• La durée de voyage de l'étudiant                              (Numérique: 1 - <15 min., 2 - 15 à 30 min.,                                                                               3 - 30 min. à 1 heure, 4 - >1 hour)        
• Le temp de travail de l'étudiant                              (Numérique: 1 - <2 heures, 2 - 2 to 5 heures ,                                                                            3 - 5 à 10 heures , 4 - >10 heures )
• Le nombre de redoublement de l'étudiant                       (Numérique: n si 1<=n<3, sinon 4)
• Les cours extrascolaire de l'étudiant(Math or Portuguese)     (Binaire: Oui ou Non)
• Les supports  educationel  de l'étudiant                      (Binaire: Oui ou Non)
• Les cours particuliers de l'étudiant                          (Binaire: Oui ou Non)
• Les activités extrascolaire de l'étudiant                     (Binaire: Oui ou Non)
• L'étudiant a frequente les classes inferieures                (Binaire: Oui ou Non)
• Si l'étudiant va poursuivre etudier dans le superieur         (Binaire: Oui ou Non)
• Si l'étudiant  a accées a internet                            (Binaire: Oui ou Non)
• Si l'étudiant  a une relation amoureuse                       (Binaire: Oui ou Non)
• Les relations familliales de l'étudiant                       (Numérique: De 1 - vraiment mauvaise à 5 - excellente)
• Le temps vacant de l'étudiant                                 (Numérique: De 1 - vraiment mauvaise à 5 - excellente)
• Si l'étudiant  sors souvent avec des amis                     (Numérique: De 1 - vraiment mauvaise à 5 - excellente)
• La consommation journaliere d'alcool de l'étudiant            (Numérique: De 1 - vraiment mauvaise à 5 - excellente)
• La consommation hebdomaire  d'alcool de l'étudiant            (Numérique: De 1 - vraiment mauvaise à 5 - excellente)
• La sante actuelle  de l'étudiant                              (Numérique: De 1 - vraiment mauvaise à 5 - excellente)
• Le nombre d'absences de l'étudiant                            (Numérique: de 0 à 93)
• La note du trimestre 1 de l'étudiant                          (Numérique: de 0 à 93)
• La note du trimestre 2 de l'étudiant                          (Numérique: de 0 à 93)
• La note final  de l'étudiant                                  (Numérique: de 0 à 93)




On étudie l'age  des fille et des garcons dans la population totale .

```{r}
n_student = nrow(student) #nb d'etudiant
age= ggplot(aes(x=age), data=student)+
  geom_histogram(binwidth = 0.50, fill="#ff691f", color="#197dff")+
  ggtitle("Age of students")
age
```

```{r}
print("l'age moyen des étudiants est : "); mean(student$age)
print("la variance de l'age des étudiants est : "); var(student$age)
print("la medianne de l'age des étudiants est : "); median(student$age)
```


On etudie les caracteristiques des écoles :
:

```{r}
student %>% distinct(school)
```
Les élèves font partie de 2 écoles au portugal MS = Mousinho da Silveira et GP = Gabriel Pereira.

```{r}
print("proportion d'étudiant a : Mousinho da Silveira")
sum(student$school=="MS")/n_student
print("proportion d'étudiant a Gabriel Pereira : ")
sum(student$school=="GP")/n_student

```


On étudie le nombre de filles et de garcons dans la population totale :

```{r}
gender= ggplot(data=student,aes(x=sex,fill=sex),color="#ff691f")+geom_bar()
gender
```
```{r}
print("proportion de fille : ");sum(student$sex=="F")/n_student
print("proportion de garçon : ");sum(student$sex=="M")/n_student
```

On étudie la santé des étudiants :

```{r}
health= ggplot(data=student,aes(x=health,fill=sex))+geom_histogram(binwidth=0.5, fill='#ff691f')


  
health
```
```{r}
print("la santé moyenne des étudiants est : "); mean(student$health)
print("la variance de la santé des étudiants est : "); var(student$health)
print("la medianne de la santé des étudiants est : "); median(student$health)
print("Pourcentage d'étudiant en bonne santé");sum(student$health>=3)/n_student

```

On peut voir que la majorité des étudiants sont en bonne santé .


On étudie l'age des étudiants 

```{r}
ages= ggplot(data=student,aes(x=age, fill=sex))+geom_histogram(binwidth=0.50,color="#ff691f")
ages
```

Comme le montre clairement le graphique ci-dessus, la plupart des étudiants de plus de 18 ans sont des étudiants de sexe masculin, car il n'y a pas d'étudiantes de plus de 20 ans.


On étudie le milieu urbain/rural des étudiants 

```{r}
area= ggplot(student, aes(x=address)) +
    geom_bar(fill='#ff691f')
area 
```
Comme on le voit clairement ci-dessus, la plupart des étudiants vivent dans des zones urbaines




```{r}
Motherjob= ggplot(student, aes(x=Mjob)) +geom_bar(fill='#ff691f')
Motherjob

```

```{r}
Fotherjob= ggplot(student, aes(x=Fjob)) +geom_bar(fill='#ff691f')
Fotherjob
```
```{r}
Fedu= ggplot(student, aes(x=Fedu)) +geom_bar(fill='#197dff', color="#ff691f")
Fedu
```

```{r}
Medu= ggplot(student, aes(x=Medu)) +geom_bar(fill='#197dff', color='#ff691f')
Medu
```
```{r}
table(student$famsize)
ggplot(student, aes(x=famsize))+geom_bar(fill='#197dff',color='#ff691f')
```


```{r}


colors <- c("#ff691f", "#197dff")

student <- student %>% mutate(note_mediane = (G1 + G2 + G3)/3)


scale_fill_manual(values = colors)
student %>%
    ggplot(aes(note_mediane)) +
    geom_density(aes(fill=address), alpha=0.8) +
    labs(title="Note moyenne des élèves ruraux et urbains", 
         subtitle="Les étudiants urbains ont un léger avantage.",
         caption="",fill="Region",x="Note",y="Pourcentage total des etudiants ") +scale_fill_manual(values = colors)
```

Le graphe que nous avons devant nous montre une légère avance des étudiants urbains en termes de résultats scolaires par rapport à leurs homologues ruraux. La courbe représentant les résultats scolaires des étudiants urbains est légèrement plus élevée et plus stable que celle des étudiants ruraux.

Cette différence peut être due à plusieurs facteurs tels que l'accès à des ressources éducatives de qualité, des infrastructures modernes, des enseignants mieux formés, ainsi qu'un environnement éducatif plus stimulant et plus compétitif.


```{r}

student <- student %>%
    mutate(famsup = ifelse(famsup == "no", "OUI", "NON")) 
#%>%
    #mutate(address = ifelse(address == "U", "urbano", "rural"))


student %>%ggplot(aes(x=higher, fill = famsup)) + geom_bar(colour = "black", alpha = 0.8, position="fill") +scale_fill_manual(values = colors) +labs(title="Soutien familial et désir d'obtenir un diplôme", 
         subtitle="Le soutien familial à un impact significatif sur les ambitions des étudiants.",
         caption="",
         fill="La famille soutient :",
         x="Volonté d'obtenir son diplome",
         y="Pourcentage ")

student %>%
    ggplot(aes(x=studytime, fill = famsup)) +
    geom_bar(colour = "black", alpha = 0.8, position="fill") +
    scale_fill_manual(values = colors) +
    labs(title="Soutien familial et heures d'étude", 
         subtitle="La famille affecte aussi visiblement l'engagement des élèves.",
         caption="",
         fill="La famille soutient :",
         x="Heures d'étude",
         y="pourcentage")
```




Le graphe que nous avons devant nous montre clairement l'impact de l'environnement familial sur la réussite scolaire des étudiants. Les étudiants qui ont bénéficié d'un soutien familial dans leur parcours éducatif ont tendance à etre plus motivée dans leur réussite scoalire et donc en conséquence a plus etudieur que les éleves ne beneficiant pas d'un environnement familial similaire .


Cependant, il est important de souligner que l'accès au soutien familial n'est pas toujours équitable et que certains étudiants peuvent être désavantagés en raison de leur environnement social et économique. Il est donc crucial de comprendre comment les facteurs sociaux et économiques peuvent influencer l'accès au soutien familial et comment cela peut affecter la réussite scolaire.

Pour cette raison, il est essentiel de mener des études plus approfondies pour comprendre l'impact social de l'environnement familial sur la réussite scolaire des étudiants. Cela permettra de mieux comprendre les besoins des étudiants et de mettre en place des politiques et des initiatives éducatives qui favorisent une égalité des chances pour tous.



2- Objectifs d’affaires


3 - Objectif technique





```{r}
student <- student %>% select(address,famsize,Pstatus,Medu,Fedu,Mjob,Fjob,reason,
                              guardian,traveltime,famsup,nursery,famrel,G1,G2,G3)
student <- student %>%mutate(mean_grade = (G1+G2+2*G3)/4)
student <- student %>%mutate(G1 = NULL,G2 = NULL,G3 = NULL,mean_grade = mean_grade >= 10)
student <- student %>% mutate_all(as.factor)
```

Extraction des données qye nous utiliserons pour notre étude.












###KAGGLE 2 
Séparation des données :

Classification :
https://veroniquetremblay.github.io/analyse_de_donnees_et_apprentissage_statistique_en_R/arbres-et-forets-aleatoires.html

```{r}
split <- initial_split(student, prop = .7, strata = "mean_grade")
#echantillonnage stratifié -> même proba de oui et non dans chaque partie
train <- training(split)
test  <- testing(split)
```

Création de l'arbre :

```{r}
# Choisir les hyperparamètres
hp <- ctree_control(minsplit = 2, #L'effectif minimal pour séparer un noeud 
                     minbucket = 1, # L'effectif minimal dans chaque noeud terminal
                     maxdepth = 70, # Hauteur (profondeur) maximale de l'arbre
                    mincriterion = 0.05) # 1-p-valeur à partir de laquelle on souhaite cesser la croissance)

# Construire l'arbre
arbre_ctree <- ctree(mean_grade~., train,control = hp)
arbre_ctree
```

Prediction :

```{r}
hat_y <- predict(arbre_ctree, # Le modèle
                 test)
hat_y
```
```{r}
sum(hat_y == test$mean_grade)/nrow(test)
```

